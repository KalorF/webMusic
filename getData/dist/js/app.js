"use strict";function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)})}}require("babel-polyfill");var puppeteer=require("puppeteer"),fs=require("fs"),dt=new Date,nowHour=dt.getHours();function getData(){return _getData.apply(this,arguments)}function _getData(){return(_getData=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){var jsonDataList,browser,page;return regeneratorRuntime.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return jsonDataList=[],_context2.next=3,puppeteer.launch();case 3:return browser=_context2.sent,_context2.next=6,browser.newPage();case 6:return page=_context2.sent,_context2.next=9,page.goto("http://music.wandhi.com/?name=周杰伦&type=qq");case 9:page.on("response",function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(res){var writeData,data,list;return regeneratorRuntime.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if("http://music.wandhi.com/"===res.url())return writeData=function(){fs.writeFile("jayjsondata.json",JSON.stringify(jsonDataList,null,4),function(e,result){e?console.error(e):console.log(result)})},_context.next=5,res.json();_context.next=16;break;case 5:if(data=_context.sent,list=data.data,jsonDataList.push.apply(jsonDataList,_toConsumableArray(list)),!(10<=list.length)){_context.next=13;break}console.log("下一页"),setTimeout(function(){page.click(".aplayer-more").catch(function(e){writeData()})},300),_context.next=16;break;case 13:return writeData(),_context.next=16,browser.close();case 16:case"end":return _context.stop()}},_callee)}));return function(_x){return _ref.apply(this,arguments)}}());case 10:case"end":return _context2.stop()}},_callee2)}))).apply(this,arguments)}nowHour%1==0&&getData();